<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Voice Assistant V2</title>
    <style>
        /* Hide ALL Branding */
        [data-testid*="branding"],
        [data-testid*="powered"],
        [class*="branding"],
        [class*="powered"],
        [class*="elevenlabs"],
        [aria-label*="ElevenLabs"],
        [aria-label*="Powered by"],
        [title*="ElevenLabs"],
        [title*="Powered by"],
        a[href*="elevenlabs"],
        a[href*="conversational-ai"],
        .elevenlabs-branding,
        .powered-by-elevenlabs,
        .branding-text,
        .footer-branding,
        .widget-branding,
        .convai-branding,
        [data-branding],
        [data-powered-by],
        [data-elevenlabs],
        elevenlabs-convai::part(branding),
        elevenlabs-convai::part(footer),
        elevenlabs-convai::part(powered-by),
        elevenlabs-convai footer,
        elevenlabs-convai .footer,
        elevenlabs-convai [class*="footer"],
        elevenlabs-convai > div:last-child,
        elevenlabs-convai [class*="bottom"],
        elevenlabs-convai [class*="attribution"],
        elevenlabs-convai iframe[src*="elevenlabs"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            width: 0 !important;
            overflow: hidden !important;
        }

        elevenlabs-convai *[style*="font-size: 12px"],
        elevenlabs-convai *[style*="font-size: 10px"],
        elevenlabs-convai *[style*="font-size: 11px"],
        elevenlabs-convai *[style*="font-size: 9px"],
        elevenlabs-convai *[style*="font-size: 8px"],
        elevenlabs-convai small,
        elevenlabs-convai .text-xs,
        elevenlabs-convai [class*="text-xs"] {
            display: none !important;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            color: #666;
            font-size: 16px;
        }

        .error {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            color: #e74c3c;
            text-align: center;
            padding: 20px;
        }

        /* V2 Mobile Optimizations */
        @media (max-width: 768px) {
            elevenlabs-convai {
                max-width: calc(100vw - 20px) !important;
                max-height: 70vh !important;
            }
            
            body {
                overflow-x: hidden;
            }
        }

        /* Enhanced branding removal for V2 */
        elevenlabs-convai a,
        elevenlabs-convai [href],
        elevenlabs-convai [class*="link"],
        elevenlabs-convai [role="link"] {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">Loading AI Assistant V2...</div>
    
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>

    <script>
        // Get agent ID from URL parameter
        function getAgentId() {
            const urlParams = new URLSearchParams(window.location.search);
            const agentId = urlParams.get('agent');
            
            if (!agentId) {
                showError('No agent ID provided. Please add ?agent=YOUR_AGENT_ID to the URL.');
                return null;
            }
            
            return agentId;
        }

        function showError(message) {
            const loading = document.getElementById('loading');
            loading.innerHTML = `
                <div class="error">
                    <h3>Configuration Error</h3>
                    <p>${message}</p>
                    <small>Example: ?agent=agent_01jxjyk81cfqrs9zer2vsp4h7e</small>
                    <p><small>Widget V2 - Mobile Hide Version</small></p>
                </div>
            `;
        }

        // Initialize widget with dynamic agent ID
        function initializeWidget() {
            const agentId = getAgentId();
            if (!agentId) return;
            
            // Create widget element
            const widgetElement = document.createElement('elevenlabs-convai');
            widgetElement.setAttribute('agent-id', agentId);
            
            // Replace loading with widget
            const loading = document.getElementById('loading');
            loading.style.display = 'none';
            document.body.appendChild(widgetElement);
            
            // Enhanced branding cleanup for V2
            setTimeout(hideBrandingV2, 300);
            setTimeout(hideBrandingV2, 600);
            setTimeout(hideBrandingV2, 1000);
            setTimeout(hideBrandingV2, 2000);
            setTimeout(hideBrandingV2, 3000);
            setTimeout(hideBrandingV2, 5000);
            setTimeout(hideBrandingV2, 8000);
            setTimeout(hideBrandingV2, 10000);
            setTimeout(hideBrandingV2, 15000);
        }

        function hideBrandingV2() {
            const allElements = document.querySelectorAll('*');
            allElements.forEach(el => {
                if (el.textContent && (
                    el.textContent.toLowerCase().includes('powered by elevenlabs') ||
                    el.textContent.toLowerCase().includes('elevenlabs') ||
                    el.textContent.toLowerCase().includes('conversational ai') ||
                    el.textContent.toLowerCase().includes('powered by') ||
                    el.textContent.toLowerCase().includes('samantha')
                )) {
                    if (el.textContent.trim().length < 100 && !el.querySelector('elevenlabs-convai')) {
                        el.style.setProperty('display', 'none', 'important');
                        el.style.setProperty('visibility', 'hidden', 'important');
                        el.style.setProperty('opacity', '0', 'important');
                        el.style.setProperty('height', '0', 'important');
                        el.style.setProperty('width', '0', 'important');
                        el.style.setProperty('overflow', 'hidden', 'important');
                        el.style.setProperty('position', 'absolute', 'important');
                        el.style.setProperty('left', '-9999px', 'important');
                        
                        // V2: More aggressive text removal
                        try {
                            if (el.children.length === 0) {
                                el.textContent = '';
                                el.innerHTML = '';
                            }
                        } catch (e) {}
                    }
                }
            });

            const widget = document.querySelector('elevenlabs-convai');
            if (widget && widget.shadowRoot) {
                try {
                    const shadowElements = widget.shadowRoot.querySelectorAll('*');
                    shadowElements.forEach(el => {
                        if (el.textContent && (
                            el.textContent.toLowerCase().includes('powered by') ||
                            el.textContent.toLowerCase().includes('elevenlabs') ||
                            el.textContent.toLowerCase().includes('samantha')
                        )) {
                            el.style.setProperty('display', 'none', 'important');
                            el.textContent = '';
                        }
                    });
                } catch (e) {}
            }

            // V2: Additional cleanup for links and small text
            const linksAndSmall = document.querySelectorAll('a, small, [href], [class*="link"]');
            linksAndSmall.forEach(el => {
                if (el.closest('elevenlabs-convai')) {
                    el.style.setProperty('display', 'none', 'important');
                }
            });
        }

        // Enhanced monitoring for V2
        const observerV2 = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    setTimeout(hideBrandingV2, 50);
                    setTimeout(hideBrandingV2, 200);
                }
            });
        });

        // Wait for ElevenLabs script to load, then initialize
        let checkCount = 0;
        const checkInterval = setInterval(() => {
            if (window.customElements && window.customElements.get('elevenlabs-convai')) {
                clearInterval(checkInterval);
                initializeWidget();
                observerV2.observe(document.body, {
                    childList: true,
                    subtree: true
                });
            } else if (checkCount++ > 50) {
                clearInterval(checkInterval);
                initializeWidget();
            }
        }, 100);

        console.log('ðŸš€ AI Widget V2 - Mobile Hide Version Loaded');
    </script>
</body>
</html>
